<?php
/**
 * Template Name: „Éù„ÉÉ„Éâ„Ç≠„É£„Çπ„Éà„Éà„ÉÉ„Éó„Éö„Éº„Ç∏„ÉÜ„É≥„Éó„É¨„Éº„Éà
 * „Éù„ÉÉ„Éâ„Ç≠„É£„Çπ„ÉàÂ∞ÇÁî®„ÅÆ„Éà„ÉÉ„Éó„Éö„Éº„Ç∏„É¨„Ç§„Ç¢„Ç¶„Éà
 */

get_header(); ?>


<main id="main-content" class="site-main" role="main">
    <!-- „Éù„ÉÉ„Éâ„Ç≠„É£„Çπ„ÉàÂ∞ÇÁî®„Éí„Éº„É≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥ -->
    <section class="podcast-hero" aria-labelledby="hero-title">
        <!-- „Éë„Éº„ÉÜ„Ç£„ÇØ„É´„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ -->
        <div class="podcast-hero-particles" aria-hidden="true">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>
        
        <div class="podcast-hero-content">
            <!-- Â∑¶ÂÅ¥Ôºö„É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
            <div class="podcast-hero-main">
                <!-- „Çø„Ç§„Éà„É´ -->
                <h1 id="hero-title" class="hero-title">ContentFreaks</h1>
                <p class="hero-subtitle">Â•Ω„Åç„Å™‰ΩúÂìÅ„ÄÅË™û„ÇäÂ∞Ω„Åè„Åù„ÅÜÔºÅ</p>
                
                <!-- „Ç¢„Éº„Éà„ÉØ„Éº„ÇØ + „Éá„Ç£„Çπ„ÇØ„É™„Éó„Ç∑„Éß„É≥„Çí1„Å§„ÅÆ„Ç≥„É≥„ÉÜ„Éä„Å´Áµ±Âêà -->
                <div class="podcast-hero-content-block">
                    <!-- „Ç¢„Éº„Éà„ÉØ„Éº„ÇØ -->
                    <div class="podcast-hero-artwork">
                        <?php 
                        $podcast_artwork = get_theme_mod('podcast_artwork');
                        if ($podcast_artwork): ?>
                            <img src="<?php echo esc_url($podcast_artwork); ?>" alt="<?php echo esc_attr(get_theme_mod('podcast_name')); ?>" class="podcast-artwork">
                        <?php else: ?>
                            <div class="podcast-artwork" style="background: var(--latest-episode-badge-bg); display: flex; align-items: center; justify-content: center; font-size: 4rem; color: var(--black);">
                                üéôÔ∏è
                            </div>
                        <?php endif; ?>
                    </div>
                    
                    <!-- „Éá„Ç£„Çπ„ÇØ„É™„Éó„Ç∑„Éß„É≥ -->
                    <div class="podcast-hero-text">
                        <div class="podcast-hero-description">
                            <?php echo esc_html(get_theme_mod('podcast_description', '„Äå„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Éï„É™„Éº„ÇØ„Çπ„Äç„ÅØ„ÄÅÂ§ßÂ≠¶ÊôÇ‰ª£„Åã„Çâ„ÅÆÂèã‰∫∫2‰∫∫„Åß„Äå„ÅÑ„ÅæÊ∞ó„Å´„Å™„Çã„ÄçÊ≥®ÁõÆ„ÅÆ„Ç®„É≥„Çø„É°„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÁÜ±„ÅèË™û„Çã„Éù„ÉÉ„Éâ„Ç≠„É£„Çπ„Éà')); ?>
                        </div>
                        
                        <!-- „Ç≥„É≥„ÉÜ„É≥„ÉÑ„Éï„É™„Éº„ÇØ„Çπ„ÅÆÊ≠©„Åø„Éö„Éº„Ç∏„Å∏„ÅÆ„É™„É≥„ÇØ -->
                        <div class="history-cta">
                            <a href="<?php echo get_permalink(get_page_by_path('history')); ?>" class="history-btn">
                                üìú „Ç≥„É≥„Éï„É™„ÅÆÊ≠©„Åø„ÇíË¶ã„Çã
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Âè≥ÂÅ¥ÔºöÁµ±Ë®àÊÉÖÂ†±„Å®„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
            <div class="podcast-hero-sidebar">
                <!-- Áµ±Ë®àÊÉÖÂ†± -->
                <div class="stats-section">
                    <h3 class="sidebar-section-title">üìä „Éù„ÉÉ„Éâ„Ç≠„É£„Çπ„ÉàÊÉÖÂ†±</h3>
                    <div class="podcast-stats">
                        <div class="podcast-stat">
                            <span class="podcast-stat-number" data-count="<?php 
                                $episode_count = get_posts(array(
                                    'meta_key' => 'is_podcast_episode',
                                    'meta_value' => '1',
                                    'post_status' => 'publish',
                                    'numberposts' => -1
                                ));
                                echo count($episode_count);
                                ?>">0
                            </span>
                            <span class="podcast-stat-label">„Ç®„Éî„ÇΩ„Éº„Éâ</span>
                        </div>
                        <div class="podcast-stat">
                            <span class="podcast-stat-number" data-count="<?php echo esc_attr(get_option('contentfreaks_listener_count', '1500')); ?>"><?php echo esc_attr(get_option('contentfreaks_listener_count', '1500')); ?>+</span>
                            <span class="podcast-stat-label">„É™„Çπ„Éä„Éº</span>
                        </div>
                        <div class="podcast-stat">
                            <span class="podcast-stat-number" data-count="4.7" data-decimal="true">0</span>
                            <span class="podcast-stat-label">Ë©ï‰æ°</span>
                        </div>
                    </div>
                </div>
                
                <!-- „ÇØ„Ç§„ÉÉ„ÇØ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
                <div class="quick-nav-section">
                    <h3 class="sidebar-section-title">üóÇÔ∏è „Ç≥„É≥„ÉÜ„É≥„ÉÑ</h3>
                    <div class="quick-nav-links">
                        <a href="<?php echo get_permalink(get_page_by_path('episodes')); ?>" class="quick-nav-btn">
                            <span class="quick-nav-icon">üéôÔ∏è</span>
                            <span class="quick-nav-label">ÂÖ®„Ç®„Éî„ÇΩ„Éº„Éâ</span>
                        </a>
                        <a href="<?php echo get_permalink(get_page_by_path('works')); ?>" class="quick-nav-btn">
                            <span class="quick-nav-icon">üìö</span>
                            <span class="quick-nav-label">‰ΩúÂìÅ„Éá„Éº„Çø„Éô„Éº„Çπ</span>
                        </a>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <script>
    // „Ç´„Ç¶„É≥„Éà„Ç¢„ÉÉ„Éó„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ - ÊúÄÈÅ©ÂåñÁâà
    document.addEventListener('DOMContentLoaded', function() {
        const statNumbers = document.querySelectorAll('.podcast-stat-number[data-count]');
        
        const animateCount = (element) => {
            const target = parseFloat(element.dataset.count);
            const isDecimal = element.dataset.decimal === 'true';
            const duration = 1500; // 2000ms ‚Üí 1500ms „Å´Áü≠Á∏Æ
            const step = target / (duration / 16);
            let current = 0;
            
            const update = () => {
                current = Math.min(current + step, target);
                
                if (isDecimal) {
                    element.textContent = current.toFixed(1);
                } else {
                    const nextEl = element.nextElementSibling;
                    element.textContent = Math.floor(current) + (nextEl?.textContent === '„É™„Çπ„Éä„Éº' ? '+' : '');
                }
                
                if (current < target) requestAnimationFrame(update);
            };
            
            update();
        };
        
        // Intersection Observer „ÅßÁîªÈù¢„Å´Ë°®Á§∫„Åï„Çå„Åü„Å®„Åç„ÅÆ„Åø„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.classList.contains('animated')) {
                    entry.target.classList.add('animated');
                    animateCount(entry.target);
                }
            });
        }, { threshold: 0.5 });
        
        statNumbers.forEach(num => observer.observe(num));
    });
    </script>



    <!-- ÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ„Çª„ÇØ„Ç∑„Éß„É≥ -->
    <section id="latest-episode" class="latest-episode-section">
        <div class="latest-episode-container">
            <div class="latest-episode-header">
                <h2>ÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ</h2>
            </div>
            
            <?php 
            // ÊäïÁ®øË®ò‰∫ã„Åã„ÇâÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ„ÇíÂèñÂæó
            $latest_episode_query = new WP_Query(array(
                'post_type' => 'post',
                'posts_per_page' => 1,
                'meta_key' => 'is_podcast_episode',
                'meta_value' => '1',
                'orderby' => 'date',
                'order' => 'DESC'
            ));
            
            $latest_episode_id = 0; // ÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ„ÅÆID„Çí‰øùÂ≠ò
            
            if ($latest_episode_query->have_posts()) :
                $latest_episode_query->the_post();
                $latest_episode_id = get_the_ID(); // ÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ„ÅÆID„ÇíÂèñÂæó
                $audio_url = get_post_meta(get_the_ID(), 'episode_audio_url', true);
                $episode_number = get_post_meta(get_the_ID(), 'episode_number', true);
                $duration = get_post_meta(get_the_ID(), 'episode_duration', true);
                $episode_category = get_post_meta(get_the_ID(), 'episode_category', true) ?: '„Ç®„Éî„ÇΩ„Éº„Éâ';
            ?>
                <div class="featured-episode">
                    <div class="featured-episode-content">
                        <div class="featured-episode-image">
                            <?php 
                            // „Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„Çí„Åæ„ÅöÁ¢∫Ë™ç
                            if (has_post_thumbnail()) : ?>
                                <?php the_post_thumbnail('large', array(
                                    'alt' => get_the_title(),
                                    'loading' => 'eager' // ÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ„ÅØÂç≥Â∫ß„Å´Ë™≠„ÅøËæº„Åø
                                )); ?>
                            <?php else : 
                                // „Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„Åå„Å™„ÅÑÂ†¥Âêà„ÄÅ„Ç®„Éî„ÇΩ„Éº„Éâ„ÅÆ„É°„Çø„Éá„Éº„Çø„Åã„ÇâÁîªÂÉèURL„ÇíÂèñÂæó„ÇíË©¶Ë°å
                                $episode_image_url = get_post_meta(get_the_ID(), 'episode_image_url', true);
                                if ($episode_image_url) : ?>
                                    <img src="<?php echo esc_url($episode_image_url); ?>" alt="<?php echo esc_attr(get_the_title()); ?>" loading="eager" style="width: 100%; height: auto; border-radius: 20px;">
                                <?php else : ?>
                                    <div class="featured-episode-default-thumbnail">üéôÔ∏è</div>
                                <?php endif; ?>
                            <?php endif; ?>
                        </div>
                        
                        <div class="featured-episode-details">
                            <div class="episode-meta-info">
                                <span class="episode-date"><?php echo get_the_date('YÂπ¥nÊúàjÊó•'); ?></span>
                            </div>
                            
                            <h3 class="featured-episode-title"><?php the_title(); ?></h3>
                            <div class="episode-actions">
                                <a href="<?php the_permalink(); ?>" class="episode-share-btn">Ë©≥Á¥∞„ÇíË¶ã„Çã</a>
                            </div>
                        </div>
                    </div>
                </div>
            <?php 
                wp_reset_postdata();
            else: 
            ?>
                <p>ÊúÄÊñ∞„ÅÆ„Ç®„Éî„ÇΩ„Éº„Éâ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ</p>
            <?php endif; ?>
        </div>
    </section>


    <!-- „Ç®„Éî„ÇΩ„Éº„Éâ‰∏ÄË¶ß -->
    <section class="episodes-section">
        <div class="episodes-container">
            <div class="episodes-header fade-in">
                <h2>ÊúÄËøë„ÅÆ„Ç®„Éî„ÇΩ„Éº„Éâ</h2>
            </div>

            
            <div class="episodes-grid">
                <?php
                // ÊäïÁ®øË®ò‰∫ã„Åã„ÇâÊúÄËøë„ÅÆ„Ç®„Éî„ÇΩ„Éº„Éâ„ÇíÂèñÂæóÔºàÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ„ÇíÈô§Â§ñÔºâ
                $recent_episodes_query = new WP_Query(array(
                    'post_type' => 'post',
                    'posts_per_page' => 3,
                    'meta_key' => 'is_podcast_episode',
                    'meta_value' => '1',
                    'orderby' => 'date',
                    'order' => 'DESC',
                    'post__not_in' => array($latest_episode_id) // ÊúÄÊñ∞„Ç®„Éî„ÇΩ„Éº„Éâ„ÇíÈô§Â§ñ
                ));
                
                if ($recent_episodes_query->have_posts()) :
                    $delay_index = 0;
                    while ($recent_episodes_query->have_posts()) : $recent_episodes_query->the_post();
                        $audio_url = get_post_meta(get_the_ID(), 'episode_audio_url', true);
                        $episode_number = get_post_meta(get_the_ID(), 'episode_number', true);
                        $duration = get_post_meta(get_the_ID(), 'episode_duration', true);
                        $episode_category = get_post_meta(get_the_ID(), 'episode_category', true) ?: '„Ç®„Éî„ÇΩ„Éº„Éâ';
                        $delay_class = 'delay-' . ($delay_index * 100 + 100);
                        $delay_index++;
                ?>
                    <article class="episode-card slide-up <?php echo esc_attr($delay_class); ?>" data-category="<?php echo esc_attr($episode_category); ?>">
                        <div class="episode-thumbnail">
                            <?php 
                            // „Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„Çí„Åæ„ÅöÁ¢∫Ë™ç
                            if (has_post_thumbnail()) : ?>
                                <?php the_post_thumbnail('medium', array(
                                    'alt' => get_the_title(),
                                    'loading' => 'lazy' // ÈÅÖÂª∂Ë™≠„ÅøËæº„Åø
                                )); ?>
                            <?php else : 
                                // „Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅÁîªÂÉè„Åå„Å™„ÅÑÂ†¥Âêà„ÄÅ„Ç®„Éî„ÇΩ„Éº„Éâ„ÅÆ„É°„Çø„Éá„Éº„Çø„Åã„ÇâÁîªÂÉèURL„ÇíÂèñÂæó„ÇíË©¶Ë°å
                                $episode_image_url = get_post_meta(get_the_ID(), 'episode_image_url', true);
                                if ($episode_image_url) : ?>
                                    <img src="<?php echo esc_url($episode_image_url); ?>" alt="<?php echo esc_attr(get_the_title()); ?>" loading="lazy" style="width: 100%; height: 200px; object-fit: cover;">
                                <?php else : ?>
                                    <div class="episode-default-thumbnail">üéôÔ∏è</div>
                                <?php endif; ?>
                            <?php endif; ?>
                        </div>
                        
                        <div class="episode-content">
                            <div class="episode-date"><?php echo get_the_date('YÂπ¥nÊúàjÊó•'); ?></div>
                            <h3 class="episode-title">
                                <a href="<?php the_permalink(); ?>"><?php the_title(); ?></a>
                            </h3>
                        </div>
                    </article>
                <?php 
                    endwhile;
                    wp_reset_postdata();
                else:
                ?>
                    <div class="episodes-empty-state">
                        <h3>„Ç®„Éî„ÇΩ„Éº„Éâ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü</h3>
                        <p>RSS„Éá„Éº„Çø„Åã„ÇâÊäïÁ®ø„Çí‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                        <?php if (current_user_can('manage_options')) : ?>
                        <a href="<?php echo admin_url('tools.php?page=contentfreaks-sync'); ?>" class="button">
                            RSSÂêåÊúüÁÆ°ÁêÜ
                        </a>
                        <?php endif; ?>
                    </div>
                <?php endif; ?>
            </div>
            
            <!-- „Ç®„Éî„ÇΩ„Éº„Éâ‰∏ÄË¶ß„Å∏„ÅÆ„É™„É≥„ÇØ -->
            <div class="episodes-cta">
                <a href="<?php echo get_permalink(get_page_by_path('episodes')); ?>" class="episodes-view-all-btn">
                    üéß ÂÖ®„Ç®„Éî„ÇΩ„Éº„Éâ„ÇíË¶ã„Çã
                </a>
                <a href="<?php echo get_permalink(get_page_by_path('blog')); ?>" class="blog-view-all-btn">
                    üìñ „Éñ„É≠„Ç∞Ë®ò‰∫ã„ÇíË¶ã„Çã
                </a>
            </div>
            
        </div>
    </section>

    <!-- „Éõ„Çπ„ÉàÁ¥π‰ªã -->
    <section class="hosts-section">
        <div class="hosts-container">
            <div class="hosts-header fade-in">
                <h2>ABOUT US</h2>
            </div>
            
            <div class="slide-up delay-100">
                <?php echo do_shortcode('[podcast_hosts]'); ?>
            </div>
            
            <!-- „Éó„É≠„Éï„Ç£„Éº„É´„Éö„Éº„Ç∏„Å∏„ÅÆ„Éú„Çø„É≥ -->
            <div class="hosts-cta fade-in delay-200">
                <a href="<?php echo get_permalink(get_page_by_path('profile')); ?>" class="hosts-profile-btn btn-primary btn-shine">
                    üë• Ë©≥„Åó„ÅÑ„Éó„É≠„Éï„Ç£„Éº„É´„ÇíË¶ã„Çã
                </a>
            </div>
        </div>
    </section>

    <!-- Á§æ‰ºöÁöÑË®ºÊòé„Éª„É¨„Éì„É•„Éº -->
    <section class="testimonials-section">
        <div class="testimonials-container">
            <div class="testimonials-header fade-in">
                <h2>„É™„Çπ„Éä„Éº„ÅÆÂ£∞</h2>
            </div>
            
            <div class="testimonials-grid">
                <div class="testimonial-card scale-in delay-100">
                    <div class="testimonial-quote">
                        „ÅÑ„Å§„ÇÇÈÖç‰ø°„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅÊØéÂ∫¶Ê•Ω„Åó„ÅèÊãùËÅ¥„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åä‰∫å‰∫∫„ÅåÁï™ÁµÑÂÜÖ„ÅßÁ¥π‰ªã„Åó„Å¶„ÅÑ„Åü„ÅÆ„Çí„Åç„Å£„Åã„Åë„Å´Ê§úÁ¥¢„Åó„Éè„Éû„Å£„Åü„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅåÂ§ö„Åè„ÅÇ„Çä„ÄÅÂÆ∂Êóè„ÇÑÂèã‰∫∫„Å´„Äå„Ç≥„É≥„Éï„É™„ÅÆÔºí‰∫∫„Åå„Ç™„Çπ„Çπ„É°„Åó„Å¶„Åü„Äç„Å®Ë©±„Åô„Åª„Å©Â•Ω„Åç„Å™Áï™ÁµÑ„Åß„Åô„ÄÇ
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">„ÉÅ</div>
                        <div class="author-info">
                            <h4>„ÉÅ„É£„É™„Åï„Çì</h4>
                            <div class="author-role">GoogleForm</div>
                        </div>
                    </div>
                </div>
                
                <div class="testimonial-card scale-in delay-200">
                    <div class="testimonial-quote">
                        „ÅÑ„Å§„ÇÇÊ•Ω„Åó„ÅèÊãùËÅ¥„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„ÅÑ„Å¶„ÅÑ„Åæ„ÅôÔºÅËá™ÂàÜ„Å®ÈÅï„ÅÜË¶ñÁÇπ„ÅÆÊÑüÊÉ≥„ÇíËÅû„Åè„Åì„Å®„ÅåÂá∫Êù•„Å¶„ÄÅ‰∏ÄÁ∑í„Å´Áõõ„Çä‰∏ä„Åå„Çå„Çã„ÅÆ„ÅåÂ¨â„Åó„ÅÑ„Åß„Åô„ÄÇ
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">„ÅÆ</div>
                        <div class="author-info">
                            <h4>„ÅÆ„Åò„Åã„Åï„Çì</h4>
                            <div class="author-role">GoogleForm</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- „Éù„ÉÉ„Éâ„Ç≠„É£„Çπ„Éà„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É† -->
    <section id="platforms" class="podcast-platforms-section">
        <div class="platforms-container">
            <div class="platforms-header fade-in">
                <h2>„Å©„Åì„Åß„ÇÇËÅ¥„Åë„Çã</h2>
                <p class="platforms-subtitle">„ÅäÂ•Ω„Åø„ÅÆ„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†„Åß„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Éï„É™„Éº„ÇØ„Çπ„Çí„ÅäÊ•Ω„Åó„Åø„Åè„Å†„Åï„ÅÑ</p>
            </div>
            <div class="slide-up delay-100">
                <?php echo do_shortcode('[podcast_platforms]'); ?>
            </div>
        </div>
    </section>


    
</main>

<script>
// ÊúÄÈÅ©Âåñ„Åï„Çå„Åü„Éï„É≠„É≥„Éà„Éö„Éº„Ç∏„Çπ„ÇØ„É™„Éó„Éà
document.addEventListener('DOMContentLoaded', function() {
    // „É¢„Éê„Ç§„É´„É¨„Ç§„Ç¢„Ç¶„Éà„ÅØCSS„ÅßÂà∂Âæ°„Åï„Çå„Å¶„ÅÑ„Çã„Åü„ÇÅ„ÄÅ
    // JavaScript„Åß„ÅÆÂº∑Âà∂ÁöÑ„Å™„Çπ„Çø„Ç§„É´ÈÅ©Áî®„ÅØ‰∏çË¶Å
    // ÂøÖË¶Å„Å´Âøú„Åò„Å¶„Åì„Åì„Å´ËªΩÈáè„Å™Ê©üËÉΩ„ÇíËøΩÂä†
});
</script>

<?php get_footer(); ?>
